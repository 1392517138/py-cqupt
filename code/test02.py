#coding:utf-8
import pymysql
import json
"""
这是抓取学校专业及学院，根据教务在线上的构建college与major表。这是学院表
"""
conn = pymysql.connect(host='127.0.0.1', port=3306, db='mooc',
                       user='root', password='13452078118')
cusor = conn.cursor()

str = '{"data":{"teachingOfficeList":[{"kkxyh":"01","kkxymc":"通信与信息工程学院","jysh":"0100","jysmc":"通信学院"},{"kkxyh":"01","kkxymc":"通信与信息工程学院","jysh":"0105","jysmc":"通信工程系"},{"kkxyh":"01","kkxymc":"通信与信息工程学院","jysh":"0106","jysmc":"电子信息工程系"},{"kkxyh":"01","kkxymc":"通信与信息工程学院","jysh":"0107","jysmc":"数字媒体技术系"},{"kkxyh":"01","kkxymc":"通信与信息工程学院","jysh":"0108","jysmc":"通信技术与网络实验中心"},{"kkxyh":"01","kkxymc":"通信与信息工程学院","jysh":"0109","jysmc":"信息工程系"},{"kkxyh":"02","kkxymc":"光电工程学院","jysh":"0200","jysmc":"光电学院"},{"kkxyh":"02","kkxymc":"光电工程学院/国际半导体学院","jysh":"0200","jysmc":"光电学院/国际半导体学院"},{"kkxyh":"02","kkxymc":"光电工程学院","jysh":"0205","jysmc":"电子工程系"},{"kkxyh":"02","kkxymc":"光电工程学院","jysh":"0206","jysmc":"光电信息工程系"},{"kkxyh":"02","kkxymc":"光电工程学院","jysh":"0207","jysmc":"微电子系"},{"kkxyh":"02","kkxymc":"光电工程学院","jysh":"0208","jysmc":"实验中心"},{"kkxyh":"02","kkxymc":"光电工程学院/国际半导体学院","jysh":"1600","jysmc":"国际半导体学院"},{"kkxyh":"03","kkxymc":"经济管理学院","jysh":"0300","jysmc":"经管学院"},{"kkxyh":"03","kkxymc":"经济管理学院/邮政学院","jysh":"0300","jysmc":"经管学院"},{"kkxyh":"03","kkxymc":"经济管理学院","jysh":"0305","jysmc":"应用经济学系"},{"kkxyh":"03","kkxymc":"经济管理学院/邮政学院","jysh":"0305","jysmc":"应用经济学系"},{"kkxyh":"03","kkxymc":"经济管理学院","jysh":"0306","jysmc":"管理工程系"},{"kkxyh":"03","kkxymc":"经济管理学院/邮政学院","jysh":"0306","jysmc":"管理工程系"},{"kkxyh":"03","kkxymc":"经济管理学院","jysh":"0307","jysmc":"工商管理系"},{"kkxyh":"03","kkxymc":"经济管理学院/邮政学院","jysh":"0307","jysmc":"工商管理系"},{"kkxyh":"03","kkxymc":"经济管理学院/邮政学院","jysh":"0308","jysmc":"电子商务系"},{"kkxyh":"03","kkxymc":"经济管理学院/邮政学院","jysh":"0309","jysmc":"经济管理实验中心"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0306","jysmc":"管理工程系"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0400","jysmc":"计算机学院"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0405","jysmc":"计算机系"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0406","jysmc":"空间信息系"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0407","jysmc":"智能科学与技术系"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0409","jysmc":"计算机基础教研部"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0410","jysmc":"计算机专业实验中心"},{"kkxyh":"04","kkxymc":"计算机科学与技术学院","jysh":"0411","jysmc":"数据科学系"},{"kkxyh":"05","kkxymc":"外国语学院","jysh":"0500","jysmc":"外语学院"},{"kkxyh":"05","kkxymc":"外国语学院","jysh":"0505","jysmc":"英语系"},{"kkxyh":"05","kkxymc":"外国语学院","jysh":"0506","jysmc":"大学英语教研一部"},{"kkxyh":"05","kkxymc":"外国语学院","jysh":"0507","jysmc":"大学英语教研二部"},{"kkxyh":"06","kkxymc":"生物信息学院","jysh":"0600","jysmc":"生物学院"},{"kkxyh":"06","kkxymc":"生物信息学院","jysh":"0605","jysmc":"生物医学工程系"},{"kkxyh":"06","kkxymc":"生物信息学院","jysh":"0606","jysmc":"生物信息系"},{"kkxyh":"07","kkxymc":"网络空间安全与信息法学院","jysh":"0700","jysmc":"法学院"},{"kkxyh":"07","kkxymc":"网络空间安全与信息法学院","jysh":"0705","jysmc":"法学系"},{"kkxyh":"07","kkxymc":"网络空间安全与信息法学院","jysh":"0706","jysmc":"知识产权系"},{"kkxyh":"07","kkxymc":"网络空间安全与信息法学院","jysh":"0708","jysmc":"信息法学实验教学中心"},{"kkxyh":"07","kkxymc":"网络空间安全与信息法学院","jysh":"0709","jysmc":"网络空间安全系"},{"kkxyh":"0705","kkxymc":"网络空间安全与信息法学院","jysh":"0705","jysmc":"法学系"},{"kkxyh":"08","kkxymc":"自动化学院","jysh":"0800","jysmc":"自动化学院"},{"kkxyh":"08","kkxymc":"自动化学院","jysh":"0805","jysmc":"自动控制系"},{"kkxyh":"08","kkxymc":"自动化学院","jysh":"0806","jysmc":"电气工程系"},{"kkxyh":"08","kkxymc":"自动化学院","jysh":"0807","jysmc":"物联网工程系"},{"kkxyh":"08","kkxymc":"自动化学院","jysh":"0808","jysmc":"自动化与电气工程实验实训中心"},{"kkxyh":"08","kkxymc":"自动化学院","jysh":"0809","jysmc":"自动化与机器人工程系"},{"kkxyh":"09","kkxymc":"体育学院","jysh":"0900","jysmc":"体育学院"},{"kkxyh":"09","kkxymc":"体育学院","jysh":"0905","jysmc":"社会体育系"},{"kkxyh":"09","kkxymc":"体育学院","jysh":"0906","jysmc":"大学体育教研部"},{"kkxyh":"10","kkxymc":"马克思主义学院","jysh":"1005","jysmc":"思想政治理论课教研部"},{"kkxyh":"10","kkxymc":"马克思主义学院","jysh":"1005","jysmc":"思想政治课教学研究中心"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1100","jysmc":"理学院"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1105","jysmc":"应用物理系"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1106","jysmc":"应用数学系"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1107","jysmc":"大学物理教研部"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1108","jysmc":"高等数学教研部"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1109","jysmc":"数理专业实验中心"},{"kkxyh":"11","kkxymc":"理学院","jysh":"1110","jysmc":"工程数学教研部"},{"kkxyh":"12","kkxymc":"传媒艺术学院","jysh":"1200","jysmc":"传媒学院"},{"kkxyh":"12","kkxymc":"传媒艺术学院","jysh":"1205","jysmc":"影视编导与传播系"},{"kkxyh":"12","kkxymc":"传媒艺术学院","jysh":"1206","jysmc":"数字媒体与动画系"},{"kkxyh":"12","kkxymc":"传媒艺术学院","jysh":"1207","jysmc":"艺术设计系"},{"kkxyh":"13","kkxymc":"软件工程学院","jysh":"1300","jysmc":"软件学院"},{"kkxyh":"13","kkxymc":"软件工程学院","jysh":"1305","jysmc":"软件理论与工程系"},{"kkxyh":"13","kkxymc":"软件工程学院","jysh":"1306","jysmc":"数字媒体技术系"},{"kkxyh":"13","kkxymc":"软件工程学院","jysh":"1307","jysmc":"软件实验中心"},{"kkxyh":"14","kkxymc":"先进制造工程学院","jysh":"1400","jysmc":"先进制造学院"},{"kkxyh":"14","kkxymc":"先进制造工程学院","jysh":"1400","jysmc":"先进学院"},{"kkxyh":"14","kkxymc":"先进制造工程学院","jysh":"1406","jysmc":"先进制造实验中心"},{"kkxyh":"14","kkxymc":"先进制造工程学院","jysh":"1407","jysmc":"机械电子工程系"},{"kkxyh":"14","kkxymc":"先进制造工程学院","jysh":"1408","jysmc":"机械设计制造系"},{"kkxyh":"15","kkxymc":"国际学院","jysh":"1500","jysmc":"国际学院"},{"kkxyh":"15","kkxymc":"国际学院","jysh":"1505","jysmc":"国际项目部"},{"kkxyh":"15","kkxymc":"国际学院","jysh":"1599","jysmc":"国际学院办公室"},{"kkxyh":"17","kkxymc":"创新创业教育学院","jysh":"1706","jysmc":"素质教育教学研究部"},{"kkxyh":"17","kkxymc":"创新创业教育学院/继续教育学院","jysh":"1706","jysmc":"素质教育教学研究部"},{"kkxyh":"21","kkxymc":"科技文献检索教研室","jysh":"2100","jysmc":"科技文献检索教研室"}],"majorList":[{"xyh":"01","zyh":"0101","xymc":"通信与信息工程学院","zymc":"通信工程"},{"xyh":"01","zyh":"0102","xymc":"通信与信息工程学院","zymc":"电子信息工程"},{"xyh":"01","zyh":"0104","xymc":"通信与信息工程学院","zymc":"信息工程"},{"xyh":"01","zyh":"0105","xymc":"通信与信息工程学院","zymc":"广播电视工程"},{"xyh":"01","zyh":"0106","xymc":"通信与信息工程学院","zymc":"数字媒体技术"},{"xyh":"01","zyh":"0190","xymc":"通信与信息工程学院","zymc":"通信工程专业卓越工程师班"},{"xyh":"01","zyh":"0191","xymc":"通信与信息工程学院","zymc":"通信学院IT精英班"},{"xyh":"02","zyh":"0103","xymc":"光电工程学院","zymc":"电子信息科学与技术"},{"xyh":"02","zyh":"0202","xymc":"光电工程学院/国际半导体学院","zymc":"微电子科学与工程"},{"xyh":"02","zyh":"0203","xymc":"光电工程学院","zymc":"电子科学与技术"},{"xyh":"02","zyh":"0204","xymc":"光电工程学院","zymc":"电磁场与无线技术"},{"xyh":"02","zyh":"0205","xymc":"光电工程学院","zymc":"光电信息科学与工程"},{"xyh":"02","zyh":"0290","xymc":"光电工程学院","zymc":"光电信息科学与工程专业实验班"},{"xyh":"02","zyh":"0290","xymc":"光电工程学院/国际半导体学院","zymc":"光电信息科学与工程专业实验班"},{"xyh":"02","zyh":"1602","xymc":"光电工程学院/国际半导体学院","zymc":"集成电路设计与集成系统"},{"xyh":"02","zyh":"1620","xymc":"光电工程学院/国际半导体学院","zymc":"微电子科学与工程专业实验班"},{"xyh":"03","zyh":"0301","xymc":"经济管理学院","zymc":"信息管理与信息系统"},{"xyh":"03","zyh":"0301","xymc":"经济管理学院/邮政学院","zymc":"信息管理与信息系统"},{"xyh":"03","zyh":"0302","xymc":"经济管理学院/邮政学院","zymc":"会计学"},{"xyh":"03","zyh":"0303","xymc":"经济管理学院","zymc":"经济学"},{"xyh":"03","zyh":"0303","xymc":"经济管理学院/邮政学院","zymc":"经济学"},{"xyh":"03","zyh":"0304","xymc":"经济管理学院/邮政学院","zymc":"市场营销"},{"xyh":"03","zyh":"0305","xymc":"经济管理学院/邮政学院","zymc":"工商管理"},{"xyh":"03","zyh":"0306","xymc":"经济管理学院/邮政学院","zymc":"电子商务"},{"xyh":"03","zyh":"0308","xymc":"经济管理学院","zymc":"工程管理"},{"xyh":"03","zyh":"0308","xymc":"经济管理学院/邮政学院","zymc":"工程管理"},{"xyh":"03","zyh":"0313","xymc":"经济管理学院/邮政学院","zymc":"物流管理"},{"xyh":"03","zyh":"0320","xymc":"经济管理学院/邮政学院","zymc":"工商管理二专业"},{"xyh":"03","zyh":"0321","xymc":"经济管理学院/邮政学院","zymc":"市场营销二专业"},{"xyh":"03","zyh":"0322","xymc":"经济管理学院/邮政学院","zymc":"经济学二专业"},{"xyh":"03","zyh":"0323","xymc":"经济管理学院/邮政学院","zymc":"创新创业实验班"},{"xyh":"03","zyh":"0394","xymc":"经济管理学院/邮政学院","zymc":"物流管理（智慧邮政方向）实验班"},{"xyh":"03","zyh":"0395","xymc":"经济管理学院","zymc":"信息技术会计实验班"},{"xyh":"03","zyh":"0395","xymc":"经济管理学院/邮政学院","zymc":"信息技术会计实验班"},{"xyh":"03","zyh":"0396","xymc":"经济管理学院","zymc":"市场营销专业实验班（中美121项目）"},{"xyh":"03","zyh":"0397","xymc":"经济管理学院","zymc":"信息管理与信息系统实验班（中美121项目）"},{"xyh":"03","zyh":"1801","xymc":"经济管理学院/邮政学院","zymc":"邮政工程"},{"xyh":"03","zyh":"1890","xymc":"经济管理学院/邮政学院","zymc":"物流管理专业实验班"},{"xyh":"04","zyh":"0401","xymc":"计算机科学与技术学院","zymc":"计算机科学与技术"},{"xyh":"04","zyh":"0403","xymc":"计算机科学与技术学院","zymc":"网络工程"},{"xyh":"04","zyh":"0404","xymc":"计算机科学与技术学院","zymc":"信息安全"},{"xyh":"04","zyh":"0405","xymc":"计算机科学与技术学院","zymc":"智能科学与技术"},{"xyh":"04","zyh":"0406","xymc":"计算机科学与技术学院","zymc":"地理信息科学"},{"xyh":"04","zyh":"0407","xymc":"计算机科学与技术学院","zymc":"空间信息与数字技术"},{"xyh":"04","zyh":"0408","xymc":"计算机科学与技术学院","zymc":"数据科学与大数据技术"},{"xyh":"04","zyh":"0491","xymc":"计算机科学与技术学院","zymc":"计算机科学与技术专业卓越工程师班"},{"xyh":"04","zyh":"0492","xymc":"计算机科学与技术学院","zymc":"信息安全专业卓越工程师班"},{"xyh":"04","zyh":"0493","xymc":"计算机科学与技术学院","zymc":"计算机科学与技术菁英班"},{"xyh":"04","zyh":"0494","xymc":"计算机科学与技术学院","zymc":"空间信息与数字技术实验班"},{"xyh":"05","zyh":"0501","xymc":"外国语学院","zymc":"英语"},{"xyh":"05","zyh":"0502","xymc":"外国语学院","zymc":"翻译"},{"xyh":"05","zyh":"Z051","xymc":"外国语学院","zymc":"英语(专升本)"},{"xyh":"06","zyh":"0601","xymc":"生物信息学院","zymc":"生物医学工程"},{"xyh":"06","zyh":"0605","xymc":"生物信息学院","zymc":"生物信息学"},{"xyh":"06","zyh":"0607","xymc":"生物信息学院","zymc":"医学信息工程"},{"xyh":"06","zyh":"0692","xymc":"生物信息学院","zymc":"生物医学工程实验班"},{"xyh":"07","zyh":"0404","xymc":"网络空间安全与信息法学院","zymc":"信息安全"},{"xyh":"07","zyh":"0492","xymc":"网络空间安全与信息法学院","zymc":"信息安全专业卓越工程师班"},{"xyh":"07","zyh":"0701","xymc":"网络空间安全与信息法学院","zymc":"法学"},{"xyh":"07","zyh":"0702","xymc":"网络空间安全与信息法学院","zymc":"知识产权"},{"xyh":"07","zyh":"0703","xymc":"网络空间安全与信息法学院","zymc":"信息安全(安法学院)"},{"xyh":"07","zyh":"0704","xymc":"网络空间安全与信息法学院","zymc":"网络空间安全"},{"xyh":"07","zyh":"070a","xymc":"网络空间安全与信息法学院","zymc":"信息安全(2018)"},{"xyh":"07","zyh":"070b","xymc":"网络空间安全与信息法学院","zymc":"信息安全专业卓越工程师班(安法学院)"},{"xyh":"08","zyh":"0801","xymc":"自动化学院","zymc":"自动化"},{"xyh":"08","zyh":"0802","xymc":"自动化学院","zymc":"测控技术与仪器"},{"xyh":"08","zyh":"0803","xymc":"自动化学院","zymc":"电气工程及其自动化"},{"xyh":"08","zyh":"0805","xymc":"自动化学院","zymc":"物联网工程"},{"xyh":"08","zyh":"0806","xymc":"自动化学院","zymc":"智能电网信息工程"},{"xyh":"08","zyh":"0807","xymc":"自动化学院","zymc":"机器人工程"},{"xyh":"08","zyh":"0890","xymc":"自动化学院","zymc":"自动化专业卓越工程师班"},{"xyh":"08","zyh":"0891","xymc":"自动化学院","zymc":"机器人工程专业实验班"},{"xyh":"09","zyh":"0901","xymc":"体育学院","zymc":"社会体育指导与管理"},{"xyh":"11","zyh":"1101","xymc":"理学院","zymc":"应用物理学"},{"xyh":"11","zyh":"1102","xymc":"理学院","zymc":"信息与计算科学"},{"xyh":"11","zyh":"1103","xymc":"理学院","zymc":"数学与应用数学"},{"xyh":"11","zyh":"1192","xymc":"理学院","zymc":"应用物理学专业实验班"},{"xyh":"11","zyh":"1193","xymc":"理学院","zymc":"数学与大数据科学专业实验班"},{"xyh":"11","zyh":"1193","xymc":"理学院","zymc":"数学与大数据科学实验班"},{"xyh":"12","zyh":"1201","xymc":"传媒艺术学院","zymc":"广播电视编导"},{"xyh":"12","zyh":"1202","xymc":"传媒艺术学院","zymc":"动画"},{"xyh":"12","zyh":"1204","xymc":"传媒艺术学院","zymc":"环境设计"},{"xyh":"12","zyh":"1205","xymc":"传媒艺术学院","zymc":"视觉传达设计"},{"xyh":"12","zyh":"1207","xymc":"传媒艺术学院","zymc":"产品设计"},{"xyh":"12","zyh":"1208","xymc":"传媒艺术学院","zymc":"数字媒体艺术"},{"xyh":"12","zyh":"1290","xymc":"传媒艺术学院","zymc":"广播电视编导专业实验班"},{"xyh":"12","zyh":"1292","xymc":"传媒艺术学院","zymc":"数字媒体艺术专业实验班"},{"xyh":"12","zyh":"Z121","xymc":"传媒艺术学院","zymc":"广播电视编导(专升本)"},{"xyh":"12","zyh":"Z122","xymc":"传媒艺术学院","zymc":"数字媒体艺术(专升本)"},{"xyh":"12","zyh":"Z123","xymc":"传媒艺术学院","zymc":"视觉传达设计(专升本)"},{"xyh":"13","zyh":"1300","xymc":"软件工程学院","zymc":"软件工程"},{"xyh":"13","zyh":"1306","xymc":"软件工程学院","zymc":"英语+软件"},{"xyh":"13","zyh":"1307","xymc":"软件工程学院","zymc":"日语+软件"},{"xyh":"13","zyh":"1390","xymc":"软件工程学院","zymc":"软件工程专业卓越工程师班"},{"xyh":"13","zyh":"G131","xymc":"软件工程学院","zymc":"软件工程（3+4）"},{"xyh":"14","zyh":"0804","xymc":"先进制造工程学院","zymc":"机械设计制造及其自动化"},{"xyh":"14","zyh":"1402","xymc":"先进制造工程学院","zymc":"机械电子工程"},{"xyh":"14","zyh":"1403","xymc":"先进制造工程学院","zymc":"机器人工程"},{"xyh":"15","zyh":"3406","xymc":"国际学院","zymc":"英语(中加)"},{"xyh":"15","zyh":"3407","xymc":"国际学院","zymc":"电子信息工程(中美)"},{"xyh":"15","zyh":"3408","xymc":"国际学院","zymc":"软件工程（中外）"},{"xyh":"15","zyh":"3409","xymc":"国际学院","zymc":"通信工程（中外）"},{"xyh":"18","zyh":"1801","xymc":"现代邮政学院","zymc":"邮政工程"},{"xyh":"18","zyh":"Z031","xymc":"现代邮政学院","zymc":"物流管理(专升本)"},{"xyh":"99","zyh":"9999","xymc":"其他","zymc":"其他"}]},"meta":{"result":100,"msg":"success"}}'

d = json.loads(str)

detail = d['data']['majorList']
xyh = []
zyh = []
xymc = []
zymc = []

for item in detail:
    xyh.append(item['xyh'])
    zyh.append(item['zyh'])
    xymc.append(item['xymc'])
    zymc.append(item['zymc'])
realxymc = []
realxyh = []
# 去重
for i,item in enumerate(xymc):
    if item not in realxymc:
        realxymc.append(item)
        realxyh.append(xyh[i])
print(realxyh,realxymc)


sql = 'INSERT INTO xy (xyh,xymc) VALUES (%s,%s)'

for i in range(len(realxymc)):
    data = (realxyh[i],realxymc[i])
    cusor.execute(sql,data)
    conn.commit()



cusor.close()
conn.close()
